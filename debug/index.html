<!doctype html>
<html>
<head>
	<title>A canvas Map of Minsk</title>

	<link rel="stylesheet" href="leaflet/leaflet.css" />
	<!--[if lte IE 8]><link rel="stylesheet" href="leaflet/leaflet.ie.css" /><![endif]-->

	<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />

    <!-- jQuery. It's not required for Kothic, but still useful for this example -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6/jquery.min.js"></script>

	<!-- Leaflet -->
	<script src="leaflet/leaflet.js"></script>

	<!-- Include Kothic renderer sources -->
	<script src="kothic-include.js"></script>

	<!-- Include Kothic leaflet layer -->
	<script src="../dist/kothic-leaflet.js"></script>

	<!-- osmosnimki.ru style (Generated from MapCSS) -->
	<script src="osmosnimki.js"></script>

	<!-- surface overlay style (Generated from MapCSS) -->
	<script src="surface.js"></script>

    <link rel="stylesheet" type="text/css" href="css/debug.css">
</head>
<body>
	<div id="map"></div>
	<div id="debug">
		<p>OpenStreetMap data rendered on the browser using <a href="http://github.com/kothic/kothic-js">Kothic JS</a></p>
		<button id="mapnik">Show Mapnik</button>
		<button id="overlay">Show overlay</button>
		<div id="tileperf">Rendering...</div>
	</div>
	<script type="text/javascript">
		var mapnik = new L.TileLayer('http://{s}.tile.osmosnimki.ru/kosmo/{z}/{x}/{y}.png', {
			attribution: "Map data &copy; 2011 OpenStreetMap contributors, Imagery by <a href='http://osmosnimki.ru'>osmosnimki.ru</a>",
			maxZoom: 22
		});

		var kothic = new L.TileLayer.Kothic({
            minZoom: 8,
            styles: ['osmosnimki-maps']
        });

		var map = new L.Map('map', {
			center: new L.LatLng(53.9, 27.55), // Minsk
			zoom: 12
		});

		kothic.on('load', function() {
			var messages = kothic.getDebugMessages(),
				len = messages.length,
				message = messages.slice(Math.max(len - 4, 0), len).join('<br />');

			document.getElementById('tileperf').innerHTML = message;
		});

		MapCSS.onImagesLoad = function() {
			map.addLayer(kothic);
		};
        
		MapCSS.preloadSpriteImage("osmosnimki-maps", "http://osmosnimki.ru/leaf/icons/osmosnimki.png");

		var mapnikVisible = false, overlayVisible = false;
        $("#mapnik").click(function () {
			if (mapnikVisible) {
				map.removeLayer(mapnik);
                $("#mapnik").text('Show Mapnik'); 
			} else {
				map.addLayer(mapnik);
                $("#mapnik").text('Hide Mapnik'); 
            }            
			mapnikVisible = !mapnikVisible;
        });

        $("#overlay").click(function () {
			if (overlayVisible) {
                $("#overlay").text('Show overlay'); 
                kothic.disableStyle('surface');
			} else {
                $("#overlay").text('Hide overlay'); 
                kothic.enableStyle('surface');
            }            
			overlayVisible = !overlayVisible;
        });
	</script>
</body>
</html>
